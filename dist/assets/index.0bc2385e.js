var t=Object.defineProperty,e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(e,a,n)=>a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const a of t)if("childList"===a.type)for(const t of a.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var r=(t,e,a)=>{const n=new Date(e.updatedAt),s=`\n  <tr class="border border-gray-600">\n    <td class="transaction__table__data">${t}</td>\n    <td class="transaction__table__data">${e.accName}</td>\n    <td class="transaction__table__data">${e.startGold}</td>\n    <td class="transaction__table__data">${e.finishGold}</td>\n    <td class="transaction__table__data">${e.goldDeposited}</td>\n    <td class="transaction__table__data">${e.goldRate}</td>\n    <td class="transaction__table__data">${n.toString().substr(7,18)}</td>\n    <td data-id="${e._id}" class="transaction__table__data edit__btn py-2">\n      <span class="material-icons p-2 rounded-lg shadow-md bg-green-500 text-md text-white focus:outline-none hover:bg-green-700 cursor-pointer">mode_edit_outline</span>\n    </td>\n    <td data-id="${e._id}" class="transaction__table__data delete__btn py-2">\n      <span class="material-icons p-2 rounded-lg shadow-md bg-red-500 text-md text-white focus:outline-none hover:bg-red-700 cursor-pointer">delete</span>\n    </td>\n  </tr>\n  `;a.innerHTML+=s},d=(t,e)=>{let a=`\n  <div class="py-2">\n    <label for="start__gold">Starting Gold</label>\n    <input type="number" name="start__gold" id="start__gold" class="text__form" value="${t.startGold}" required>\n  </div>\n  <div class="py-2">\n    <label for="finish__gold">Finish Gold</label>\n    <input type="number" name="finish__gold" id="finish__gold" class="text__form" value="${t.finishGold}" required>\n  </div>\n  <div class="py-2">\n    <label for="gold__deposited">Gold Deposited</label>\n    <input type="number" name="gold__deposited" id="gold__deposited" class="text__form" value="${t.goldDeposited}" required>\n  </div>\n  <div class="py-2">\n    <label>Gold Rate</label>\n    <input type="number" name="gold__rate" class="text__form" value="${t.goldRate}" required>\n  </div>\n  <div class="py-2">\n    <button id="submit" class="my-2 p-3 rounded-lg shadow-md bg-green-500 cursor-pointer text-md text-white font-bold">\n      Simpan\n    </button>\n  </div>\n  `;e.innerHTML=a},o=t=>{t.innerHTML+='\n    <div class="py-2">\n      <label for="acc__name">Nama Player</label>\n      <input type="text" name="acc__name" id="acc__name" class="text__form" required>\n    </div>\n    <div class="py-2">\n      <label for="start__gold">Starting Gold</label>\n      <input type="number" name="start__gold" id="start__gold" class="text__form" required>\n    </div>\n    <div class="py-2">\n      <label for="finish__gold">Finish Gold</label>\n      <input type="number" name="finish__gold" id="finish__gold" class="text__form" required>\n    </div>\n    <div class="py-2">\n      <label for="gold__deposited">Jumlah Gold di pick-up</label>\n      <input type="number" name="gold__deposited" id="gold__deposited" class="text__form" required>\n    </div>\n    <div class="py-2">\n      <input type="submit" value="Simpan" class="my-2 p-3 rounded-lg shadow-md bg-red-500 cursor-pointer text-md text-white font-bold">\n    </div>\n  '},l=(t,e)=>{const a=document.createElement("tr"),n=document.createElement("td"),s=document.createElement("td"),r=document.createElement("td"),d=document.createElement("td"),o=document.createElement("td"),l=document.createElement("td"),i=document.createElement("td"),c=document.createElement("td"),_=document.createElement("td"),u=document.createElement("span"),m=document.createElement("span");a.setAttribute("id","table_trans_data"),a.setAttribute("data-id",`${t.startGold},${t.finishGold},${t.goldDeposited},${t.insertedAt},${t.goldRate}`),n.setAttribute("class","transaction__table__data"),s.setAttribute("class","transaction__table__data"),r.setAttribute("class","transaction__table__data"),d.setAttribute("class","transaction__table__data"),o.setAttribute("class","transaction__table__data"),l.setAttribute("class","transaction__table__data"),_.setAttribute("class","transaction__table__data"),i.setAttribute("class","transaction__table__data edit__btn py-2"),i.setAttribute("data-id",t._id),c.setAttribute("class","transaction__table__data delete__btn py-2"),c.setAttribute("data-id",t._id),u.setAttribute("class","material-icons p-2 rounded-lg shadow-md bg-green-500 text-md text-white focus:outline-none hover:bg-green-700 cursor-pointer"),m.setAttribute("class","material-icons p-2 rounded-lg shadow-md bg-red-500 text-md text-white focus:outline-none hover:bg-red-700 cursor-pointer"),n.innerText=t.accName,s.innerText=t.accServer,r.innerText=t.startGold,d.innerText=t.finishGold,o.innerText=t.goldDeposited,l.innerText=t.insertedAt,_.innerText=t.goldRate,u.innerText="mode_edit_outline",m.innerText="delete",i.append(u),c.append(m),a.append(n,s,r,d,o,_,l,i,c),e.append(a)},i=(t,e,a)=>{const n=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),o=document.createElement("label"),l=document.createElement("label"),i=document.createElement("label"),c=document.createElement("input"),_=document.createElement("input"),u=document.createElement("input"),m=document.createElement("input");n.setAttribute("class","py-2"),s.setAttribute("class","py-2"),r.setAttribute("class","py-2"),d.setAttribute("class","py-2"),c.setAttribute("type","text"),_.setAttribute("type","text"),u.setAttribute("type","text"),c.setAttribute("class","text__form"),_.setAttribute("class","text__form"),u.setAttribute("class","text__form"),c.setAttribute("name","acc__name"),_.setAttribute("name","acc__server"),u.setAttribute("name","acc__class"),c.setAttribute("required",""),_.setAttribute("required",""),u.setAttribute("required",""),m.setAttribute("type","submit"),m.setAttribute("class","my-2 p-3 rounded-lg shadow-md bg-red-500 cursor-pointer text-md text-white font-bold"),o.innerText="Nama Player",l.innerText="Player Server",i.innerText="Player Class",c.value=t.accName,_.value=t.accServer,u.value=t.accClass,m.value="Simpan",n.append(o,c),s.append(l,_),r.append(i,u),d.append(m),e.append(n,s,r,d),t.dataRekap.forEach((t=>{const e=new Date(t.createdAt);let n=`\n        <tr class="border border-gray-600">\n          <td class="transaction__table__data">${t.startGold}</td>\n          <td class="transaction__table__data">${t.finishGold}</td>\n          <td class="transaction__table__data">${t.goldDeposited}</td>\n          <td class="transaction__table__data">${t.goldRate}</td>\n          <td class="transaction__table__data">${e.toString().slice(4,16)}</td>\n        </tr>\n    `;a.innerHTML+=n}))};var c=(t,e,a)=>{const n=new Headers({"Content-type":"application/json; charset=UTF-8"});return new Request(t,{method:e,headers:n,body:JSON.stringify(a)})},_=async(t,e)=>{try{const a=await fetch(t);if(!a.ok)throw Error("No Data Available");const n=(await a.json()).data;let s=1;e.innerHTML="",(t=>{const e=t,a=new Date;return e.filter((t=>{const e=a.toString().slice(8,15);return new Date(t.insertedAt).toString().includes(e)}))})(n).forEach((t=>{r(s++,t,e)}))}catch(a){return console.log(a.message)}},u=async t=>{try{const e=await fetch(t);if(!e.ok)throw Error("No Data Available");const a=await e.json();return await a.data}catch(e){return console.log(e.message)}},m=async t=>{try{const e=await fetch(t),a=await e.json();"success"==a.status?(alert("Berhasil Edit Data"),window.location.replace("http://localhost:3000")):alert(`${a.status} Gagal Edit Data`)}catch(e){return console.log(e.message)}},p=async(t,e)=>{try{const a=await fetch(e),n=await a.json();"success"==n.status?(alert("Berhasil Hapus Data"),t.target.parentElement.parentElement.remove()):alert(`${n.status} Gagal Hapus Data`)}catch(a){return console.log(a.message)}},b=async t=>{try{if(!(await fetch(t)).ok)throw Error("Failed to add transaction");alert("Berhasil menambahkan data baru"),window.location.replace("http://localhost:3000")}catch(e){console.log(e.message)}};const g=fetch("http://localhost:5000/api/transactions_recap").then((t=>t.json())).then((t=>t.data));var h=async t=>{const e=await g;t.innerHTML="",e.forEach((e=>{const a=new Date(e.insertedAt).toString().slice(8,24);let n=`\n      <tr class="border border-gray-600">\n        <td class="transaction__table__data">${e.accName}</td>\n        <td class="transaction__table__data">${e.accServer}</td>\n        <td class="transaction__table__data">${e.accClass}</td>\n        <td class="transaction__table__data">${e.playerGain}</td>\n        <td class="transaction__table__data">${e.companyGain}</td>\n        <td class="transaction__table__data">${a}</td>\n        <td data-id="${e._id}" id="details_recap" class="transaction__table__data">\n          <span class="material-icons p-2 rounded-lg shadow-md bg-green-500 text-md text-white focus:outline-none hover:bg-green-700 cursor-pointer">mode_edit_outline</span>\n        </td>\n      </tr>\n    `;t.innerHTML+=n}))},y=async t=>{try{const e=await fetch(t),a=await e.json();"success"==a.status?window.location.replace("http://localhost:3000"):alert(`${a.status} Gagal Edit Data`)}catch(e){return console.log(e.message)}};const f="http://localhost:5000/api/transactions",v="http://localhost:5000/api/transactions_recap",E=document.getElementById("wrapper"),w=document.getElementById("wrapper_for_input"),A=document.getElementById("wrapper_recap_details"),L=document.getElementById("modal_body"),$=document.getElementById("create_transaction_form"),x=document.getElementById("recap_details_form"),k=document.querySelector(".show__transaction"),G=document.getElementById("show_recap_transactions"),T=document.getElementById("input_trans");_(f,k),T.addEventListener("click",(()=>{w.classList.add("edit__process__bg"),$.classList.add("input__trans__body"),o($),$.addEventListener("submit",(t=>{t.preventDefault();const e={accName:$.acc__name.value,startGold:$.start__gold.value,finishGold:$.finish__gold.value,goldDeposited:$.gold__deposited.value,goldRate:null};if(parseInt(e.goldDeposited,10)>parseInt(e.finishGold,10))alert("finish gold tidak boleh kurang dari gold deposited");else{const t=c(f,"POST",e);b(t)}}))})),k.addEventListener("click",(t=>{const e=t.target.parentElement.getAttribute("data-id");if(t.target.parentElement.classList.contains("edit__btn")&&(E.classList.add("edit__process__bg"),L.classList.add("modal__body"),u(`${f}/${e}`).then((t=>{d(t,L);document.getElementById("submit").addEventListener("click",(()=>{!function(){const t={startGold:L.start__gold.value,finishGold:L.finish__gold.value,goldDeposited:L.gold__deposited.value,goldRate:L.gold__rate.value};if(parseInt(t.goldDeposited,10)>parseInt(t.finishGold,10))alert("finish gold tidak boleh kurang dari gold deposited");else{const a=c(`${f}/${e}`,"PUT",t);m(a)}}()}))}))),t.target.parentElement.classList.contains("delete__btn")){const a=c(`${f}/${e}`,"DELETE",null);p(t,a)}}));const D=document.getElementById("searchByName");D.addEventListener("keyup",(()=>{if(""!==D.value){const t="http://localhost:5000/search",r=D.value,d=async()=>{const e=await fetch(`${t}?term=${r}`);return(await e.json()).data};k.innerHTML="",d().then((t=>{t.map((t=>{l(t,k)}));const r=document.querySelectorAll("#table_trans_data"),d=[];r.forEach((t=>{const e=t.getAttribute("data-id").split(",");d.push({result:e})}));const o={sva:[...d]},i={dataRekap:[]};o.sva.forEach((t=>{i.dataRekap.push(((t,r)=>{for(var d in r||(r={}))a.call(r,d)&&s(t,d,r[d]);if(e)for(var d of e(r))n.call(r,d)&&s(t,d,r[d]);return t})({},t.result))}));let _=[];if(i.dataRekap.length){const t=i.dataRekap.map((t=>t={startGold:Number(t[0]),finishGold:Number(t[1]),goldDeposited:Number(t[2]),goldRate:Number(t[4]),createdAt:t[3]}));_=t}document.getElementById("rekapp").addEventListener("click",(()=>{if(_.length>=12){const t={accName:D.value,accServer:null,accClass:null,dataRekap:_,playerGain:null,companyGain:null};console.log(t);const e=c(v,"POST",t);(async()=>{try{if(!(await fetch(e)).ok)throw new Error("Gagal menambah data rekap");alert("Berhasil menambah data rekap")}catch(t){console.log(t.message)}})(),_=[],D.value=""}else console.log("Jumlah transaksi minimum untuk direkap adalah 12x")}))}))}else""===D.value&&_(f,k)})),document.getElementById("route_to_recap").onclick=function(){const t=document.getElementById("transactions_container"),e=document.getElementById("recap_container");t.setAttribute("hidden",!0),e.removeAttribute("hidden",!0),h(G)};const S=document.getElementById("recap_details_table");G.addEventListener("click",(t=>{const e=t.target.parentElement,a=e.getAttribute("data-id");if("details_recap"===e.id){(async()=>{try{const t=await fetch(`${v}/${a}`);if(!t.ok)throw Error("fail to fetch the data");return(await t.json()).data}catch(t){console.log(t.message)}})().then((t=>{const e=A.querySelector("table");A.classList.add("edit__process__bg"),x.classList.add("input__trans__body"),e.classList.add("input__trans__body"),e.removeAttribute("hidden"),S.innerHTML="",i(t,x,S),x.addEventListener("submit",(e=>{e.preventDefault();const n={accServer:x.acc__server.value,accClass:x.acc__class.value,dataRekap:t.dataRekap},s=c(`${v}/${a}`,"PUT",n);y(s)}))}))}})),E.addEventListener("click",(t=>{t.target.classList.contains("edit__process__bg")&&(E.classList.remove("edit__process__bg"),L.classList.remove("modal__body"),L.innerHTML="")})),w.addEventListener("click",(t=>{t.target.classList.contains("edit__process__bg")&&(w.classList.remove("edit__process__bg"),$.classList.remove("input__trans__body"),$.innerHTML="")})),A.addEventListener("click",(t=>{if(t.target.classList.contains("edit__process__bg")){const t=A.querySelector("table");A.classList.remove("edit__process__bg"),x.classList.remove("input__trans__body"),t.classList.remove("input__trans__body"),t.setAttribute("hidden",!0),x.innerHTML=""}}));
